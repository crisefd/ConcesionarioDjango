{% extends "base.html" %}
 
{% block title %}Inicio{% endblock %}
 
{% block content %}
  {% if user.is_authenticated %}
    <div class="content-wrapper" style="min-height: 1096px;">
      <section class="content-header">
        <h1>Bienvenido {{user.username}}, su sesion esta iniciada</h1>
        <li class="header"><a href="/cuentas/{{user.charge}}/{{user.username}}"><i class="fa fa-circle-o text-red"></i> <span>Inicio</span></a></li>
      </section>
      <section class="content"></section>
    </div>
  {%else %}
      <div class="content-wrapper" style="min-height: 1096px;">
      <div class="login-box">
      <div class="login-logo">
        
      </div><!-- /.login-logo -->
      <div class="login-box-body">
        <p class="login-box-msg">Sign in to start your session</p>
        <form  method="post">{% csrf_token %}
          <div class="form-group has-feedback">
            {{ form.username }}
            <span class="glyphicon glyphicon-envelope form-control-feedback"></span>
          </div>
          <div class="form-group has-feedback">
            {{ form.password }}
            <span class="glyphicon glyphicon-lock form-control-feedback"></span>
          </div>
          <div class="row">
            <div class="col-xs-8">
              <div class="checkbox icheck">
                <label>
                  <input type="checkbox"> Remember Me
                </label>
              </div>
            </div><!-- /.col -->
            <div class="col-xs-4">
              <button type="submit" class="btn btn-primary btn-block btn-flat">Sign In</button>
            </div><!-- /.col -->
          </div>
        </form>

        <!-- /.social-auth-links -->

        

      </div><!-- /.login-box-body -->
    </div>
  </div>- /container -->
  {%endif %}
{%comment%}
<script>
    //For getting CSRF token
function getCookie(name) {
          var cookieValue = null;
          if (document.cookie && document.cookie != '') {
                var cookies = document.cookie.split(';');
          for (var i = 0; i < cookies.length; i++) {
               var cookie = jQuery.trim(cookies[i]);
          // Does this cookie string begin with the name we want?
          if (cookie.substring(0, name.length + 1) == (name + '=')) {
            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
              break;
             }
          }
      }
 return cookieValue;
}


//For doing AJAX post

//When submit is clicked
 $("#submit").click(function(e) {

      //Prevent default submit. Must for Ajax post.Beginner's pit.
       e.preventDefault();

      //Prepare csrf token
       var csrftoken = getCookie('csrftoken');


      //Collect data from fields
       var username = $('#usernameInput').val();
       //var password = $('#inputPassword').val();

      //This is the Ajax post.Observe carefully. It is nothing but details of where_to_post,what_to_post
      //Send data  
       $.ajax({
             url : window.location.href, // the endpoint,commonly same url
             type : "POST", // http method
             data : { csrfmiddlewaretoken : csrftoken, username : username}, // data sent with the post request

             // handle a successful response
             success : function(json) {
               console.log(json); // another sanity check
               //On success show the data posted to server as a message
               alert('Hi   '+json['username'] +'!.' + '  You have succesfully logged in:');
             },

             // handle a non-successful response
             error : function(xhr,errmsg,err) {
                console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
             }
            });
});
</script> 
{%endcomment%}
{% endblock %}
